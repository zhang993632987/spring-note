# 4.3 Spring Boot客户端集成Config服务

## 1. 增加Maven依赖

```xml
<properties>
    <spring-cloud.version>2021.0.8</spring-cloud.version>
</properties>

<dependencies>
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-bootstrap</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-config</artifactId>
    </dependency>
</dependencies>

<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-dependencies</artifactId>
            <version>${spring-cloud.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>
```

## 2. bootstrap.yml配置文件

在定义了Maven依赖项后，我们需要告知微服务在哪里与Spring Cloud Config服务器端进行联系。

{% hint style="info" %}
在使用Spring Cloud Config的Spring Boot服务中，配置信息可以在以下任何一个文件中设置：

* **bootstrap.yml**
* **bootstrap.properties**
* **application.yml**
* **application.properties**

<mark style="color:orange;">**bootstrap.yml文件在读取其他配置信息之前，会先读取应用程序属性。**</mark>

一般来说，**bootstrap.yml**文件包含服务的**应用程序名称**、**应用程序profile**和**联系Config服务器端的URI**。

任何想要保留在本地服务（而不是存储在Spring Cloud Config中）的其他配置信息，都可以在本地**application.yml**文件中进行设置。<mark style="color:orange;">**通常情况下，存储在application.yml文件中的信息是你可能希望提供给服务的配置数据，即使Spring Cloud Config服务不可用。**</mark>
{% endhint %}

```yaml
spring:
  profiles:
    active: dev
  application:
    name: cloud-learning
  cloud:
    config:
      uri: http://localhost:8071/
```

* **spring.application.name**是应用程序的名称，必须直接映射到Spring Cloud Config服务器端中的配置文件的名称。
* **spring.profiles.active**用于告诉Spring Boot应用程序应该运行哪个profile。
* **spring.cloud.config.uri**是Config服务器端端点的位置。

{% hint style="success" %}
如果要覆盖这些默认值，可以通过将客户端服务项目编译并打包到JAR文件，然后使用<mark style="color:blue;">**-D**</mark>系统属性来运行这个JAR文件来实现：

```bash
java -Dspring.cloud.config.uri=http://localhost:8071 \
     -Dspring.profiles.active=dev \
     -jar target/cloud-learning-0.0.1-SNAPSHOT.jar
```
{% endhint %}
